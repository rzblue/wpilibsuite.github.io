<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WPILibC++: frc::PoseEstimator3d&lt; WheelSpeeds, WheelPositions &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="wpilib-128.png"/></td>
  <td id="projectalign">
   <div id="projectname">WPILibC++<span id="projectnumber">&#160;2025.1.1-beta-3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('classfrc_1_1_pose_estimator3d.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classfrc_1_1_pose_estimator3d-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">frc::PoseEstimator3d&lt; WheelSpeeds, WheelPositions &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This class wraps odometry to fuse latency-compensated vision measurements with encoder measurements.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_pose_estimator3d_8h_source.html">frc/estimator/PoseEstimator3d.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a074b789f99ff95c7dffe94ad0075cc97" id="r_a074b789f99ff95c7dffe94ad0075cc97"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a074b789f99ff95c7dffe94ad0075cc97">PoseEstimator3d</a> (<a class="el" href="classfrc_1_1_kinematics.html">Kinematics</a>&lt; WheelSpeeds, WheelPositions &gt; &amp;kinematics, <a class="el" href="classfrc_1_1_odometry3d.html">Odometry3d</a>&lt; WheelSpeeds, WheelPositions &gt; &amp;odometry, const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 4 &gt; &amp;stateStdDevs, const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 4 &gt; &amp;visionMeasurementStdDevs)</td></tr>
<tr class="memdesc:a074b789f99ff95c7dffe94ad0075cc97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a <a class="el" href="classfrc_1_1_pose_estimator3d.html" title="This class wraps odometry to fuse latency-compensated vision measurements with encoder measurements.">PoseEstimator3d</a>.  <br /></td></tr>
<tr class="separator:a074b789f99ff95c7dffe94ad0075cc97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e0b966d6e89593cb24093b019762956" id="r_a3e0b966d6e89593cb24093b019762956"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3e0b966d6e89593cb24093b019762956">SetVisionMeasurementStdDevs</a> (const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 4 &gt; &amp;visionMeasurementStdDevs)</td></tr>
<tr class="memdesc:a3e0b966d6e89593cb24093b019762956"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the pose estimator's trust in vision measurements.  <br /></td></tr>
<tr class="separator:a3e0b966d6e89593cb24093b019762956"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65672893706ff6cc01c9f7fc13894f1e" id="r_a65672893706ff6cc01c9f7fc13894f1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a65672893706ff6cc01c9f7fc13894f1e">ResetPosition</a> (const <a class="el" href="classfrc_1_1_rotation3d.html">Rotation3d</a> &amp;gyroAngle, const WheelPositions &amp;wheelPositions, const <a class="el" href="classfrc_1_1_pose3d.html">Pose3d</a> &amp;pose)</td></tr>
<tr class="memdesc:a65672893706ff6cc01c9f7fc13894f1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the robot's position on the field.  <br /></td></tr>
<tr class="separator:a65672893706ff6cc01c9f7fc13894f1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9bef969a72426adcfa4e0a21bc2ba07" id="r_ad9bef969a72426adcfa4e0a21bc2ba07"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad9bef969a72426adcfa4e0a21bc2ba07">ResetPose</a> (const <a class="el" href="classfrc_1_1_pose3d.html">Pose3d</a> &amp;pose)</td></tr>
<tr class="memdesc:ad9bef969a72426adcfa4e0a21bc2ba07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the robot's pose.  <br /></td></tr>
<tr class="separator:ad9bef969a72426adcfa4e0a21bc2ba07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ad0d6fc8a43ec39e660f0a80fc1c571" id="r_a1ad0d6fc8a43ec39e660f0a80fc1c571"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ad0d6fc8a43ec39e660f0a80fc1c571">ResetTranslation</a> (const <a class="el" href="classfrc_1_1_translation3d.html">Translation3d</a> &amp;translation)</td></tr>
<tr class="memdesc:a1ad0d6fc8a43ec39e660f0a80fc1c571"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the robot's translation.  <br /></td></tr>
<tr class="separator:a1ad0d6fc8a43ec39e660f0a80fc1c571"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03e05f8dba1a5eb39e2613cc52fea63b" id="r_a03e05f8dba1a5eb39e2613cc52fea63b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a03e05f8dba1a5eb39e2613cc52fea63b">ResetRotation</a> (const <a class="el" href="classfrc_1_1_rotation3d.html">Rotation3d</a> &amp;rotation)</td></tr>
<tr class="memdesc:a03e05f8dba1a5eb39e2613cc52fea63b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the robot's rotation.  <br /></td></tr>
<tr class="separator:a03e05f8dba1a5eb39e2613cc52fea63b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6e0619711ad4fb729786948a630123f" id="r_ae6e0619711ad4fb729786948a630123f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfrc_1_1_pose3d.html">Pose3d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae6e0619711ad4fb729786948a630123f">GetEstimatedPosition</a> () const</td></tr>
<tr class="memdesc:ae6e0619711ad4fb729786948a630123f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the estimated robot pose.  <br /></td></tr>
<tr class="separator:ae6e0619711ad4fb729786948a630123f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22f9a6caaa2725137bf061452690da65" id="r_a22f9a6caaa2725137bf061452690da65"><td class="memItemLeft" align="right" valign="top">std::optional&lt; <a class="el" href="classfrc_1_1_pose3d.html">Pose3d</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a22f9a6caaa2725137bf061452690da65">SampleAt</a> (units::second_t timestamp) const</td></tr>
<tr class="memdesc:a22f9a6caaa2725137bf061452690da65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the pose at a given timestamp, if the buffer is not empty.  <br /></td></tr>
<tr class="separator:a22f9a6caaa2725137bf061452690da65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f07cedbc4a446f7b2c3b74676d7ddd4" id="r_a5f07cedbc4a446f7b2c3b74676d7ddd4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5f07cedbc4a446f7b2c3b74676d7ddd4">AddVisionMeasurement</a> (const <a class="el" href="classfrc_1_1_pose3d.html">Pose3d</a> &amp;visionRobotPose, units::second_t timestamp)</td></tr>
<tr class="memdesc:a5f07cedbc4a446f7b2c3b74676d7ddd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a vision measurement to the Kalman Filter.  <br /></td></tr>
<tr class="separator:a5f07cedbc4a446f7b2c3b74676d7ddd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbab33f2deee6f24f552ff5bb7da0ea3" id="r_adbab33f2deee6f24f552ff5bb7da0ea3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adbab33f2deee6f24f552ff5bb7da0ea3">AddVisionMeasurement</a> (const <a class="el" href="classfrc_1_1_pose3d.html">Pose3d</a> &amp;visionRobotPose, units::second_t timestamp, const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 4 &gt; &amp;visionMeasurementStdDevs)</td></tr>
<tr class="memdesc:adbab33f2deee6f24f552ff5bb7da0ea3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a vision measurement to the Kalman Filter.  <br /></td></tr>
<tr class="separator:adbab33f2deee6f24f552ff5bb7da0ea3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98da18edbf7cb2b2bc15f48e6ddba804" id="r_a98da18edbf7cb2b2bc15f48e6ddba804"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfrc_1_1_pose3d.html">Pose3d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a98da18edbf7cb2b2bc15f48e6ddba804">Update</a> (const <a class="el" href="classfrc_1_1_rotation3d.html">Rotation3d</a> &amp;gyroAngle, const WheelPositions &amp;wheelPositions)</td></tr>
<tr class="memdesc:a98da18edbf7cb2b2bc15f48e6ddba804"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the pose estimator with wheel encoder and gyro information.  <br /></td></tr>
<tr class="separator:a98da18edbf7cb2b2bc15f48e6ddba804"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10833a9d0f9b50dc45cb2ffc705cea5b" id="r_a10833a9d0f9b50dc45cb2ffc705cea5b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfrc_1_1_pose3d.html">Pose3d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a10833a9d0f9b50dc45cb2ffc705cea5b">UpdateWithTime</a> (units::second_t currentTime, const <a class="el" href="classfrc_1_1_rotation3d.html">Rotation3d</a> &amp;gyroAngle, const WheelPositions &amp;wheelPositions)</td></tr>
<tr class="memdesc:a10833a9d0f9b50dc45cb2ffc705cea5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the pose estimator with wheel encoder and gyro information.  <br /></td></tr>
<tr class="separator:a10833a9d0f9b50dc45cb2ffc705cea5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename WheelSpeeds, typename WheelPositions&gt;<br />
class frc::PoseEstimator3d&lt; WheelSpeeds, WheelPositions &gt;</div><p>This class wraps odometry to fuse latency-compensated vision measurements with encoder measurements. </p>
<p>Robot code should not use this directly- Instead, use the particular type for your drivetrain (e.g., <a class="el" href="classfrc_1_1_differential_drive_pose_estimator3d.html" title="This class wraps Differential Drive Odometry to fuse latency-compensated vision measurements with dif...">DifferentialDrivePoseEstimator3d</a>). It will correct for noisy vision measurements and encoder drift. It is intended to be an easy drop-in for <a class="el" href="classfrc_1_1_odometry3d.html" title="Class for odometry.">Odometry3d</a>. It is also intended to be an easy replacement for <a class="el" href="classfrc_1_1_pose_estimator.html" title="This class wraps odometry to fuse latency-compensated vision measurements with encoder measurements.">PoseEstimator</a>, only requiring the addition of a standard deviation for Z and appropriate conversions between 2D and 3D versions of geometry classes. (See Pose3d(Pose2d), Rotation3d(Rotation2d), Translation3d(Translation2d), and <a class="el" href="classfrc_1_1_pose3d.html#a986c8a5aef00704b815afa5cf7050942" title="Returns a Pose2d representing this Pose3d projected into the X-Y plane.">Pose3d.ToPose2d()</a>.)</p>
<p><a class="el" href="#a98da18edbf7cb2b2bc15f48e6ddba804" title="Updates the pose estimator with wheel encoder and gyro information.">Update()</a> should be called every robot loop.</p>
<p><a class="el" href="#a5f07cedbc4a446f7b2c3b74676d7ddd4" title="Adds a vision measurement to the Kalman Filter.">AddVisionMeasurement()</a> can be called as infrequently as you want; if you never call it, then this class will behave like regular encoder odometry.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">WheelSpeeds</td><td>Wheel speeds type. </td></tr>
    <tr><td class="paramname">WheelPositions</td><td>Wheel positions type. </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a074b789f99ff95c7dffe94ad0075cc97" name="a074b789f99ff95c7dffe94ad0075cc97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a074b789f99ff95c7dffe94ad0075cc97">&#9670;&#160;</a></span>PoseEstimator3d()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename WheelSpeeds , typename WheelPositions &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfrc_1_1_pose_estimator3d.html">frc::PoseEstimator3d</a>&lt; WheelSpeeds, WheelPositions &gt;::PoseEstimator3d </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfrc_1_1_kinematics.html">Kinematics</a>&lt; WheelSpeeds, WheelPositions &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>kinematics</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfrc_1_1_odometry3d.html">Odometry3d</a>&lt; WheelSpeeds, WheelPositions &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>odometry</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 4 &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>stateStdDevs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 4 &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>visionMeasurementStdDevs</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a <a class="el" href="classfrc_1_1_pose_estimator3d.html" title="This class wraps odometry to fuse latency-compensated vision measurements with encoder measurements.">PoseEstimator3d</a>. </p>
<dl class="section warning"><dt>Warning</dt><dd>The initial pose estimate will always be the default pose, regardless of the odometry's current pose.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">kinematics</td><td>A correctly-configured kinematics object for your drivetrain. </td></tr>
    <tr><td class="paramname">odometry</td><td>A correctly-configured odometry object for your drivetrain. </td></tr>
    <tr><td class="paramname">stateStdDevs</td><td>Standard deviations of the pose estimate (x position in meters, y position in meters, and heading in radians). Increase these numbers to trust your state estimate less. </td></tr>
    <tr><td class="paramname">visionMeasurementStdDevs</td><td>Standard deviations of the vision pose measurement (x position in meters, y position in meters, and z position in meters, and angle in radians). Increase these numbers to trust the vision pose measurement less. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a5f07cedbc4a446f7b2c3b74676d7ddd4" name="a5f07cedbc4a446f7b2c3b74676d7ddd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f07cedbc4a446f7b2c3b74676d7ddd4">&#9670;&#160;</a></span>AddVisionMeasurement() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename WheelSpeeds , typename WheelPositions &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classfrc_1_1_pose_estimator3d.html">frc::PoseEstimator3d</a>&lt; WheelSpeeds, WheelPositions &gt;::AddVisionMeasurement </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_pose3d.html">Pose3d</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>visionRobotPose</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">units::second_t</td>          <td class="paramname"><span class="paramname"><em>timestamp</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a vision measurement to the Kalman Filter. </p>
<p>This will correct the odometry pose estimate while still accounting for measurement noise.</p>
<p>This method can be called as infrequently as you want, as long as you are calling <a class="el" href="#a98da18edbf7cb2b2bc15f48e6ddba804" title="Updates the pose estimator with wheel encoder and gyro information.">Update()</a> every loop.</p>
<p>To promote stability of the pose estimate and make it robust to bad vision data, we recommend only adding vision measurements that are already within one meter or so of the current pose estimate.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">visionRobotPose</td><td>The pose of the robot as measured by the vision camera. </td></tr>
    <tr><td class="paramname">timestamp</td><td>The timestamp of the vision measurement in seconds. Note that if you don't use your own time source by calling <a class="el" href="#a10833a9d0f9b50dc45cb2ffc705cea5b" title="Updates the pose estimator with wheel encoder and gyro information.">UpdateWithTime()</a>, then you must use a timestamp with an epoch since FPGA startup (i.e., the epoch of this timestamp is the same epoch as <a class="el" href="classfrc_1_1_timer.html#a1a0b1c162a033bbf4d7053eee550745c" title="Return the FPGA system clock time in seconds.">frc::Timer::GetFPGATimestamp()</a>. This means that you should use <a class="el" href="classfrc_1_1_timer.html#a1a0b1c162a033bbf4d7053eee550745c" title="Return the FPGA system clock time in seconds.">frc::Timer::GetFPGATimestamp()</a> as your time source in this case. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="adbab33f2deee6f24f552ff5bb7da0ea3" name="adbab33f2deee6f24f552ff5bb7da0ea3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbab33f2deee6f24f552ff5bb7da0ea3">&#9670;&#160;</a></span>AddVisionMeasurement() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename WheelSpeeds , typename WheelPositions &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classfrc_1_1_pose_estimator3d.html">frc::PoseEstimator3d</a>&lt; WheelSpeeds, WheelPositions &gt;::AddVisionMeasurement </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_pose3d.html">Pose3d</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>visionRobotPose</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">units::second_t</td>          <td class="paramname"><span class="paramname"><em>timestamp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 4 &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>visionMeasurementStdDevs</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a vision measurement to the Kalman Filter. </p>
<p>This will correct the odometry pose estimate while still accounting for measurement noise.</p>
<p>This method can be called as infrequently as you want, as long as you are calling <a class="el" href="#a98da18edbf7cb2b2bc15f48e6ddba804" title="Updates the pose estimator with wheel encoder and gyro information.">Update()</a> every loop.</p>
<p>To promote stability of the pose estimate and make it robust to bad vision data, we recommend only adding vision measurements that are already within one meter or so of the current pose estimate.</p>
<p>Note that the vision measurement standard deviations passed into this method will continue to apply to future measurements until a subsequent call to <a class="el" href="#a3e0b966d6e89593cb24093b019762956" title="Sets the pose estimator&#39;s trust in vision measurements.">SetVisionMeasurementStdDevs()</a> or this method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">visionRobotPose</td><td>The pose of the robot as measured by the vision camera. </td></tr>
    <tr><td class="paramname">timestamp</td><td>The timestamp of the vision measurement in seconds. Note that if you don't use your own time source by calling <a class="el" href="#a10833a9d0f9b50dc45cb2ffc705cea5b" title="Updates the pose estimator with wheel encoder and gyro information.">UpdateWithTime()</a>, then you must use a timestamp with an epoch since FPGA startup (i.e., the epoch of this timestamp is the same epoch as <a class="el" href="classfrc_1_1_timer.html#a1a0b1c162a033bbf4d7053eee550745c" title="Return the FPGA system clock time in seconds.">frc::Timer::GetFPGATimestamp()</a>. This means that you should use <a class="el" href="classfrc_1_1_timer.html#a1a0b1c162a033bbf4d7053eee550745c" title="Return the FPGA system clock time in seconds.">frc::Timer::GetFPGATimestamp()</a> as your time source in this case. </td></tr>
    <tr><td class="paramname">visionMeasurementStdDevs</td><td>Standard deviations of the vision pose measurement (x position in meters, y position in meters, and heading in radians). Increase these numbers to trust the vision pose measurement less. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae6e0619711ad4fb729786948a630123f" name="ae6e0619711ad4fb729786948a630123f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6e0619711ad4fb729786948a630123f">&#9670;&#160;</a></span>GetEstimatedPosition()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename WheelSpeeds , typename WheelPositions &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfrc_1_1_pose3d.html">Pose3d</a> <a class="el" href="classfrc_1_1_pose_estimator3d.html">frc::PoseEstimator3d</a>&lt; WheelSpeeds, WheelPositions &gt;::GetEstimatedPosition </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the estimated robot pose. </p>
<dl class="section return"><dt>Returns</dt><dd>The estimated robot pose in meters. </dd></dl>

</div>
</div>
<a id="ad9bef969a72426adcfa4e0a21bc2ba07" name="ad9bef969a72426adcfa4e0a21bc2ba07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9bef969a72426adcfa4e0a21bc2ba07">&#9670;&#160;</a></span>ResetPose()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename WheelSpeeds , typename WheelPositions &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classfrc_1_1_pose_estimator3d.html">frc::PoseEstimator3d</a>&lt; WheelSpeeds, WheelPositions &gt;::ResetPose </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_pose3d.html">Pose3d</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>pose</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Resets the robot's pose. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pose</td><td>The pose to reset to. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a65672893706ff6cc01c9f7fc13894f1e" name="a65672893706ff6cc01c9f7fc13894f1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65672893706ff6cc01c9f7fc13894f1e">&#9670;&#160;</a></span>ResetPosition()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename WheelSpeeds , typename WheelPositions &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classfrc_1_1_pose_estimator3d.html">frc::PoseEstimator3d</a>&lt; WheelSpeeds, WheelPositions &gt;::ResetPosition </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_rotation3d.html">Rotation3d</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>gyroAngle</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const WheelPositions &amp;</td>          <td class="paramname"><span class="paramname"><em>wheelPositions</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_pose3d.html">Pose3d</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>pose</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Resets the robot's position on the field. </p>
<p>The gyroscope angle does not need to be reset in the user's robot code. The library automatically takes care of offsetting the gyro angle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gyroAngle</td><td>The current gyro angle. </td></tr>
    <tr><td class="paramname">wheelPositions</td><td>The distances traveled by the encoders. </td></tr>
    <tr><td class="paramname">pose</td><td>The estimated pose of the robot on the field. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a03e05f8dba1a5eb39e2613cc52fea63b" name="a03e05f8dba1a5eb39e2613cc52fea63b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03e05f8dba1a5eb39e2613cc52fea63b">&#9670;&#160;</a></span>ResetRotation()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename WheelSpeeds , typename WheelPositions &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classfrc_1_1_pose_estimator3d.html">frc::PoseEstimator3d</a>&lt; WheelSpeeds, WheelPositions &gt;::ResetRotation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_rotation3d.html">Rotation3d</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>rotation</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Resets the robot's rotation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rotation</td><td>The rotation to reset to. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1ad0d6fc8a43ec39e660f0a80fc1c571" name="a1ad0d6fc8a43ec39e660f0a80fc1c571"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ad0d6fc8a43ec39e660f0a80fc1c571">&#9670;&#160;</a></span>ResetTranslation()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename WheelSpeeds , typename WheelPositions &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classfrc_1_1_pose_estimator3d.html">frc::PoseEstimator3d</a>&lt; WheelSpeeds, WheelPositions &gt;::ResetTranslation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_translation3d.html">Translation3d</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>translation</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Resets the robot's translation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">translation</td><td>The pose to translation to. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a22f9a6caaa2725137bf061452690da65" name="a22f9a6caaa2725137bf061452690da65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22f9a6caaa2725137bf061452690da65">&#9670;&#160;</a></span>SampleAt()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename WheelSpeeds , typename WheelPositions &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt; <a class="el" href="classfrc_1_1_pose3d.html">Pose3d</a> &gt; <a class="el" href="classfrc_1_1_pose_estimator3d.html">frc::PoseEstimator3d</a>&lt; WheelSpeeds, WheelPositions &gt;::SampleAt </td>
          <td>(</td>
          <td class="paramtype">units::second_t</td>          <td class="paramname"><span class="paramname"><em>timestamp</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the pose at a given timestamp, if the buffer is not empty. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timestamp</td><td>The pose's timestamp. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The pose at the given timestamp (or std::nullopt if the buffer is empty). </dd></dl>

</div>
</div>
<a id="a3e0b966d6e89593cb24093b019762956" name="a3e0b966d6e89593cb24093b019762956"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e0b966d6e89593cb24093b019762956">&#9670;&#160;</a></span>SetVisionMeasurementStdDevs()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename WheelSpeeds , typename WheelPositions &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classfrc_1_1_pose_estimator3d.html">frc::PoseEstimator3d</a>&lt; WheelSpeeds, WheelPositions &gt;::SetVisionMeasurementStdDevs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 4 &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>visionMeasurementStdDevs</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the pose estimator's trust in vision measurements. </p>
<p>This might be used to change trust in vision measurements after the autonomous period, or to change trust as distance to a vision target increases.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">visionMeasurementStdDevs</td><td>Standard deviations of the vision pose measurement (x position in meters, y position in meters, and heading in radians). Increase these numbers to trust the vision pose measurement less. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a98da18edbf7cb2b2bc15f48e6ddba804" name="a98da18edbf7cb2b2bc15f48e6ddba804"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98da18edbf7cb2b2bc15f48e6ddba804">&#9670;&#160;</a></span>Update()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename WheelSpeeds , typename WheelPositions &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfrc_1_1_pose3d.html">Pose3d</a> <a class="el" href="classfrc_1_1_pose_estimator3d.html">frc::PoseEstimator3d</a>&lt; WheelSpeeds, WheelPositions &gt;::Update </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_rotation3d.html">Rotation3d</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>gyroAngle</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const WheelPositions &amp;</td>          <td class="paramname"><span class="paramname"><em>wheelPositions</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Updates the pose estimator with wheel encoder and gyro information. </p>
<p>This should be called every loop.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gyroAngle</td><td>The current gyro angle. </td></tr>
    <tr><td class="paramname">wheelPositions</td><td>The distances traveled by the encoders.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The estimated pose of the robot in meters. </dd></dl>

</div>
</div>
<a id="a10833a9d0f9b50dc45cb2ffc705cea5b" name="a10833a9d0f9b50dc45cb2ffc705cea5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10833a9d0f9b50dc45cb2ffc705cea5b">&#9670;&#160;</a></span>UpdateWithTime()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename WheelSpeeds , typename WheelPositions &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfrc_1_1_pose3d.html">Pose3d</a> <a class="el" href="classfrc_1_1_pose_estimator3d.html">frc::PoseEstimator3d</a>&lt; WheelSpeeds, WheelPositions &gt;::UpdateWithTime </td>
          <td>(</td>
          <td class="paramtype">units::second_t</td>          <td class="paramname"><span class="paramname"><em>currentTime</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_rotation3d.html">Rotation3d</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>gyroAngle</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const WheelPositions &amp;</td>          <td class="paramname"><span class="paramname"><em>wheelPositions</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Updates the pose estimator with wheel encoder and gyro information. </p>
<p>This should be called every loop.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">currentTime</td><td>The time at which this method was called. </td></tr>
    <tr><td class="paramname">gyroAngle</td><td>The current gyro angle. </td></tr>
    <tr><td class="paramname">wheelPositions</td><td>The distances traveled by the encoders.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The estimated pose of the robot in meters. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>frc/estimator/<a class="el" href="_pose_estimator3d_8h_source.html">PoseEstimator3d.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefrc.html">frc</a></li><li class="navelem"><a class="el" href="classfrc_1_1_pose_estimator3d.html">PoseEstimator3d</a></li>
    <li class="footer">Generated on Mon Dec 16 2024 00:29:08 for WPILibC++ by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
